# ScreenCover
这是一个用于Windows 10及Windows 11的会话级别屏幕覆盖程序，旨在通过内核级解决方案来实现屏幕覆盖功能。它可以在屏幕上显示一个覆盖层，阻止用户与屏幕上的内容进行交互，
除非用户输入了正确的口令。

原理上，它使用CreateDesktop函数创建一个新的桌面，并将其设置为当前桌面。然后，它在这个新的桌面上创建一个全屏窗口，覆盖整个屏幕。通过这种方式，用户无法与原有桌面上的内容进行交互。
因此，其他传统的程序通常无法影响到这个桌面上窗口的显示。绝大多数快捷键在这个桌面上不会被处理（除了WinLogon维护的CAD快捷键等），因此用户无法在不输入口令的前提下通过常规方式退出覆盖状态。

考虑到能够访问物理设备的用户可以使用CAD安全键来短暂切换到安全桌面，从而打开任务管理器。程序通过拷贝特权进程令牌的方式获取UI_ACCESS特权，从而获取与屏幕键盘平级、高于置顶状态任务管理器的窗口级。

此外，程序还通过周期性调用BringWindowToTop等接口确保平级窗口无法遮盖该窗口。

内核方面，驱动程序注册多个回调处理函数，阻止无关进程访问桌面用户对象，确保只有特定的进程可以与覆盖窗口桌面环境进行交互；也对进程进行了写保护，避免其他进程意外干预遮盖进程的运行，从而
导致用户无法退出遮盖桌面。还通过注册模块加载回调函数，确保恶意模块无法滥用驱动程序来实现自我保护。

## 构建
使用VS2020或更高版本打开解决方案文件，编译生成。

## 部署
你需要为驱动程序进行签名，除非你使用系统的测试模式。其他程序可以构建后直接使用。